!function(e){"use strict";e(document).ready(function(){function a(a,i,c){var s=0==c?C.cal1:C.cal2;(function e(a){a.empty();for(var n=0;n<7;n++)a.append("<div>"+p[n].substring(0,3)+"</div>")})(s.weekline),s.datesBody.empty();for(var f=function e(a,n){for(var d=[],i=1;i<t(n,a)+1;i++)d.push({day:i,weekday:p[r(n,a,i)]});return d}(a,i),l=0,_=!1;!_;)p[l]==f[0].weekday?_=!0:(s.datesBody.append('<div class="blank"></div>'),l++);for(var $=0;$<42-l;$++)if($>=f.length)s.datesBody.append('<div class="blank"></div>');else{var g=f[$].day,w=new Date(i,a,g);if((g!=o.getDate()&&a==o.getMonth()||a!=o.getMonth())&&w<o)var k='<div class="past-date">';else var k=d(w)?'<div class="today">':"<div>";s.datesBody.append(k+g+"</div>")}s.calHeader.find("h2").text(m[a]+" "+i),s.weekline.find("div").css("color","#444444"),s.datesBody.find(".today").css("color","#00bdaa");var b=!1;n(J),(y=s.datesBody.find("div")).on("click",function(){if(b=e(this),s.name,T&&H){h=O(b,s);var a=new Date(v.year,v.month,v.date),t=new Date(u.year,u.month,u.date),r=new Date(h.year,h.month,h.date);t>r&&r>a?(u=h,D.find(".calendar_content").find("div").each(function(){e(this).removeClass("selected")}),(J={})[v.year]={},J[v.year][v.month]=[v.date],J=S(v,u,J)):(J={},v=[],u=[],T=!1,H=!1,D.find(".calendar_content").find("div").each(function(){e(this).removeClass("selected")}))}if(T){H=!0,u=O(b,s);var a=new Date(v.year,v.month,v.date),t=new Date(u.year,u.month,u.date);if(a>t){var d=u;u=v,(J={})[(v=d).year]={},J[v.year][v.month]=[v.date]}else a.getTime()==t.getTime()&&(J={},v=[],u=[],T=!1,H=!1,e(this).removeClass("selected"));J=S(v,u,J)}else T=!0,J[(v=O(b,s)).year]={},J[v.year][v.month]=[v.date];n(J)})}function n(a){if(!e.isEmptyObject(a)){var n=k.find("div"),t=x.find("div");function r(n,t,r){if(n in a&&t in a[n]){var d=a[n][t];for(var i in d)r.each(function(a){parseInt(e(this).text())==d[i]&&e(this).addClass("selected")})}}r(c,s,n),r(l,f,t)}}function t(e,a){return new Date(e,a+1,0).getDate()}function r(e,a,n){return new Date(e,a,n).getDay()}function d(e){var a;return o.getFullYear()+"/"+(o.getMonth()+1)+"/"+o.getDate()==e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate()}function i(e,a,n){var t,r;return"next"==n?(t=(e+1)%12,r=11==e?a+1:a):(t=0==e?11:e-1,r=0==e?a-1:a),[t,r]}var o,c,s,f,l,y,v,u,h,_,m=["January","Feburary","March","April","May","June","July","August","September","October","November","December"],p=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],$=e("#calendar_first"),g=$.find(".calendar_header"),w=$.find(".calendar_weekdays"),k=$.find(".calendar_content"),b=e("#calendar_second"),B=b.find(".calendar_header"),M=b.find(".calendar_weekdays"),x=b.find(".calendar_content"),D=e(".calendar"),F=D.find(".calendar_header").find(".switch-month"),C={cal1:{name:"first",calHeader:g,weekline:w,datesBody:k},cal2:{name:"second",calHeader:B,weekline:M,datesBody:x}},T=!1,H=!1,J={};function O(e,a){var n,t,r,d={};return t="first"==(n=a.name)?s:f,r="first"==n?c:l,d={calNum:n,date:parseInt(e.text()),month:t,year:r}}function S(e,a,n){if(a.date>e.date||a.month>e.month||a.year>e.year){var r=a.year,d=a.month,i=a.date;if(r>e.year){n[r]={},n[r][d]=[];for(var o=1;o<=a.date;o++)n[r][d].push(o);for(d-=1;d>=0;){n[r][d]=[];for(var o=1;o<=t(r,d);o++)n[r][d].push(o);d-=1}for(r-=1,i=t(r,d=11);r>e.year;){n[r]={};for(var o=0;o<12;o++){n[r][o]=[];for(var c=1;c<=t(r,o);c++)n[r][o].push(c)}r-=1}}if(d>e.month){if(e.year==a.year){n[r][d]=[];for(var o=1;o<=a.date;o++)n[r][d].push(o);d-=1}for(;d>e.month;){n[r][d]=[];for(var o=1;o<=t(r,d);o++)n[r][d].push(o);d-=1}i=t(r,d)}for(var o=e.date+1;o<=i;o++)n[r][d].push(o)}return n}c=(o=new Date).getFullYear(),f=(_=i(s=o.getMonth(),c,"next"))[0],l=_[1],a(s,c,0),a(f,l,1),F.on("click",function(){var n,t,r,d;r=i(s,c,t=-1!=e(this).attr("class").indexOf("left")?"previous":"next"),d=i(f,l,t),s=r[0],c=r[1],f=d[0],l=d[1],a(s,c,0),a(f,l,1),y=D.find(".calendar_content").find("div")})})}(jQuery);